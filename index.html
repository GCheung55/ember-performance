<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Ember Performance Suite</title>
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/app.css">
</head>
<body>

<script src="js/libs/ascii-table.min.js"></script>
<script src="js/libs/jquery-1.9.1.js"></script>
<script>
  var handlebarsLib = "js/libs/handlebars-v1.3.0.js";

  if(window.location.search){
    (function() {
      var params = window.location.search.slice(1).split('&');
      for (var i = 0, l = params.length; i < l; i++) {
        var parts = params[i].split('=');

        if (parts[0] === 'ember') {
          window.testVersion = parts[1];
        } else if (parts[0] === 'handlebars') {
          handlebarsLib = parts[1];
        }
      }
    })()
  }

  window.testVersion = window.testVersion || "http://builds.emberjs.com/canary/ember.prod.js";

  // Canary requires handlebars 2.0
  if (window.testVersion.indexOf('canary') !== -1) {
    handlebarsLib = "http://builds.handlebarsjs.com.s3.amazonaws.com/handlebars-v2.0.0.js"
  }
  document.write('<script src="' + handlebarsLib + '"><\/script>');

  // support for v=http://path.to.ember and v=file://
  if(window.testVersion.match(/^(file|http)/)) {
    document.write('<script src="' + window.testVersion + '"><\/script>');
  } else {
    document.write('<script src="js/libs/ember.' + window.testVersion + '.js"><\/script>');
  }
</script>
<script src="js/app.js"></script>
<script src="js/models.js"></script>
<script src="js/profilers/object_create.js"></script>
<script src="js/profilers/render_list.js"></script>
<script src="js/profilers/template_binding.js"></script>
<script src="js/profilers/html_binding.js"></script>
<script src="js/profilers/complex_list.js"></script>
<script src="js/profilers/get.js"></script>
<script src="js/helpers.js"></script>

<script type="text/x-handlebars" data-template-name="components/nested-thing">
  a: {{a}}
</script>

<script type="text/x-handlebars" data-template-name="components/my-template-thing">
  a: {{a}}
  b: {{b}}
  c: {{c}}
  d: {{d}}
  {{nested-thing a=a}}
</script>

<script type="text/x-handlebars" data-template-name="complexItems">
  <ul>
  {{#each view.listItems}}
    <li>{{my-thing data=a}} {{my-thing data=b}} {{my-thing data=c}} {{my-thing data=d}}</li>
    <li>{{my-thing data=a}} {{my-thing data=b}} {{my-thing data=c}} {{my-thing data=d}}</li>
    <li>{{my-template-thing a=a b=b c=c d=d}}</li>
    <li>{{my-template-thing a=a b=b c=c d=d}}</li>
  {{/each}}
  </ul>
</script>

<script type="text/x-handlebars" data-template-name="listItems">
  <ul>
  {{#each view.listItems}}
    <li>{{this}}</li>
  {{/each}}
  </ul>
</script>

<script type="text/x-handlebars" data-template-name="htmlBindings">
  {{{view.html}}}
</script>

<script type="text/x-handlebars" data-template-name="templateBindings">
  {{#each view.people}}
    <p>{{name}} / {{age}}</p>
  {{/each}}
</script>

<script type="text/x-handlebars" data-template-name='application'>
  <div class="container">
    <h1>Ember Performance Suite : Ember {{testVersion}}</h1>
    <p>
    Select Ember Version {{view Ember.Select content=versions value=selectedVersion}}
    </p>

    <button {{action 'profObjectCreate'}} {{bind-attr disabled="profiling"}} class="btn">Object.create()</button>
    <button {{action 'profGet'}} {{bind-attr disabled="profiling"}} class="btn">Ember.get()</button>
    <button {{action 'profRenderList'}} {{bind-attr disabled="profiling"}} class="btn">Render List of Items</button>
    <button {{action 'profTemplateBindings'}} {{bind-attr disabled="profiling"}} class="btn">Template Bindings</button>
    <button {{action 'profHtmlBindings'}} {{bind-attr disabled="profiling"}} class="btn">HTML Bindings</button>
    <button {{action 'profComplexList'}} {{bind-attr disabled="profiling"}} class="btn">Complex List</button>

    <div style='min-height:30px; margin-top: 10px;'>
      {{#if profiling}}
        Profiling ({{testsRun}}/{{testCount}})... Please be patient.
      {{/if}}
    </div>

    {{#if results}}
      <h3>Results ({{version}})</h3>

      <table class="table">
        <tr>
          <th>Name</th>
          <th># Runs</th>
          <th>Geometric Mean</th>
          <th>Mean</th>
          <th>Std. Dev</th>
          <th>Max</th>
        </tr>
        {{#each results}}
        <tr>
          <td>{{name}}</td>
          <td>{{times.length}}</td>
          <td>{{time geometricMean}}</td>
          <td>{{time mean}}</td>
          <td>{{time standardDeviation}}</td>
          <td>{{time max}}</td>
        </tr>
        {{/each}}
      </table>

      {{#if showAscii}}
        <h3>Ascii Results</h3>
        <pre>{{{asciiTable}}}</pre>
      {{/if}}

      <button {{action 'showAscii'}} {{bind-attr disabled=profiling}} class='btn'>Show Ascii</button>
      <button {{action 'clearResults'}} {{bind-attr disabled=profiling}} class="btn">Clear Results</button>
    {{/if}}
  </div>

  <div id='scratch-container'>
    {{view "scratch"}}
  </div>
</script>

</body>
</html>
